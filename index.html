<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>J; Compiler</title>
  <style>
    body {
      font-family: monospace;
      background: #0f0f0f;
      color: #00ff9c;
      padding: 20px;
    }

    /* Container for editor + line numbers */
    .editor-container {
      display: flex;
      border: 1px solid #00ff9c;
      background: #111;
    }

    /* Line numbers column */
    .line-numbers {
      padding: 10px;
      text-align: right;
      user-select: none;
      color: #00ff9c;
      background: #0a0a0a;
      border-right: 1px solid #00ff9c;
      min-width: 30px;
    }

    /* Code textarea */
    #code {
      width: 100%;
      height: 200px;
      background: #111;
      color: #00ff9c;
      border: none;
      padding: 10px;
      resize: none;
      outline: none;
      white-space: pre;
    }

    button {
      margin-top: 10px;
      padding: 10px;
      background: #00ff9c;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }

    #screen {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #00ff9c;
      min-height: 100px;
    }

    details {
      margin-top: 20px;
      border: 1px solid #00ff9c;
      padding: 10px;
      background: #111;
    }

    summary {
      cursor: pointer;
      font-weight: bold;
      color: #00ff9c;
    }

    .doc-section-title {
      color: #00ff9c;
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>J; Playground</h1>

<div class="editor-container">
  <div id="lineNumbers" class="line-numbers">1</div>
  <textarea id="code" oninput="updateLineNumbers()">
code.J;
show screen hi
nE/e: 8*9
show screen done
  </textarea>
</div>

<button onclick="runJ()">Run J;</button>

<div id="screen"></div>

<details>
  <summary>Documentation</summary>

  <div class="doc-section-title">J; syntax</div>
  To make the IDE recognize the code, type:
  <br>
  <code>code.j;</code>
  <br><br>

  <div class="doc-section-title">Putting information on the screen</div>
  To put text onto the screen type:
  <br>
  <code>show screen X</code>
  <br><br>

  <div class="doc-section-title">Putting information in the console</div>
  To put text in the console type:
  <br>
  <code>show console X</code>
  <br><br>

  <div class="doc-section-title">Variables</div>
  This will be really simple because there are no different types of variables.
  <br>
  To make a variable type:
  <br>
  <code>x = x</code>
  <br><br>

  <div class="doc-section-title">Loops</div>
  To make a program repeat itself a set number of times type:
  <br>
  <code>loop x-(code, no parentheses needed)-</code>
  <br>
  To make a program repeat itself a random number of times type:
  <br>
  <code>loop random-(code, no parentheses needed)-</code>
  <br>
  To make a program repeat itself an infinite number of times type:
  <br>
  <code>loop infinite-(code, no parentheses needed)-</code>
  <br><br>

  <div class="doc-section-title">Functions</div>
  To make a function type:
  <br>
  <code>make functionName-(parameters if any)- -code-</code>
  <br><br>

  <div class="doc-section-title">Comments</div>
  To make a comment type:
  <br>
  <code>Comment: (your comment, no parentheses needed)-</code>
  <br><br>

  <div class="doc-section-title">Math</div>
  To do basic operations type:
  <br>
  <code>nE/e: x*y = z</code> (for multiplication)
  <br>
  <code>nE/e: x/y = z</code> (for division)
  <br>
  <code>nE/e: x-y = z</code> (for subtraction)
  <br>
  <code>nE/e: x+y = z</code> (for addition)
  <br>
  <code>nE/e</code> stands for numericalExpression/equation.
  <br><br>

  <div class="doc-section-title">Conditionals</div>
  To type a conditional, type:
  <br>
  <code>if condition-(code if true)-</code>
  <br>
  Or:
  <br>
  <code>if condition-(code if true)-else-(code if false)-</code>
</details>

<script>
function updateLineNumbers() {
  const code = document.getElementById("code");
  const lineNumbers = document.getElementById("lineNumbers");

  const lines = code.value.split("\n").length;
  let numberText = "";

  for (let i = 1; i <= lines; i++) {
    numberText += i + "<br>";
  }

  lineNumbers.innerHTML = numberText;
}

// Run once on load
updateLineNumbers();

function runJ() {
  const input = document.getElementById("code").value.split("\n");
  const screen = document.getElementById("screen");
  screen.innerHTML = "";

  let vars = {};
  let started = false;

  for (let rawLine of input) {
    let line = rawLine.trim();
    if (line === "") continue;

    // Header
    if (!started) {
      if (line === "code.J;") {
        started = true;
        continue;
      } else {
        screen.innerHTML = "❌ Missing code.J; header";
        return;
      }
    }

    // Comment
    if (line.startsWith("Comment:")) continue;

    // show screen
    if (line.startsWith("show screen")) {
      let text = line.replace("show screen", "").trim();
      screen.innerHTML += text + "<br>";
      continue;
    }

    // show console
    if (line.startsWith("show console")) {
      let text = line.replace("show console", "").trim();
      console.log(text);
      continue;
    }

    // Math expression
    if (line.startsWith("nE/e:")) {
      let expr = line.replace("nE/e:", "").trim();
      try {
        let result = eval(expr);
        screen.innerHTML += result + "<br>";
      } catch {
        screen.innerHTML += "❌ Math error<br>";
      }
      continue;
    }

    // Variable assignment
    if (line.includes("=")) {
      let parts = line.split("=");
      let name = parts[0].trim();
      let value = parts[1].trim();

      if (!isNaN(value)) {
        vars[name] = Number(value);
      } else {
        vars[name] = value;
      }
      continue;
    }

    // Unknown command
    screen.innerHTML += "❌ Unknown command: " + line + "<br>";
  }
}
</script>

</body>
</html>
