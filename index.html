<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>J; Compiler</title>
  <style>
    body {
      font-family: monospace;
      background: #0f0f0f;
      color: #00ff9c;
      padding: 20px;
    }

    /* Container for editor + line numbers */
    .editor-container {
      display: flex;
      border: 1px solid #00ff9c;
      background: #111;
    }

    /* Line numbers column */
    .line-numbers {
      padding: 10px;
      text-align: right;
      user-select: none;
      color: #00ff9c;
      background: #0a0a0a;
      border-right: 1px solid #00ff9c;
      min-width: 30px;
    }

    /* Code textarea */
    #code {
      width: 100%;
      height: 200px;
      background: #111;
      color: #00ff9c;
      border: none;
      padding: 10px;
      resize: none;
      outline: none;
      white-space: pre;
    }

    button {
      margin-top: 10px;
      padding: 10px;
      background: #00ff9c;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }

    #screen {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #00ff9c;
      min-height: 100px;
    }

    details {
      margin-top: 20px;
      border: 1px solid #00ff9c;
      padding: 10px;
      background: #111;
    }

    summary {
      cursor: pointer;
      font-weight: bold;
      color: #00ff9c;
    }

    .doc-section-title {
      color: #00ff9c;
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>J; Playground</h1>

<div class="editor-container">
  <div id="lineNumbers" class="line-numbers">1</div>
  <textarea id="code" oninput="updateLineNumbers()">
code.J;
show screen hi
nE/e: 8*9
show screen done
  </textarea>
</div>

<button onclick="runJ()">Run J;</button>

<div id="screen"></div>

<details>
  <summary>Documentation</summary>

  <div class="doc-section-title">J; Language Documentation</div>
  <br><br>
Putting information on the screen<br>
Version 0.1 — Syntax by Carter Hookey<br>
<br>
------------------------------------------<br>
1. File Header<br>
------------------------------------------<br>
Every J; program must begin with:<br>
code.J;<br>
This tells the IDE or compiler that the file contains J; code.<br>
<br>
------------------------------------------<br>
2. Output Commands<br>
------------------------------------------<br>
Show text on the screen:<br>
show screen X<br>
<br>
Show text in the console:<br>
show console X<br>
<br>
------------------------------------------<br>
3. Variables<br>
------------------------------------------<br>
J; uses simple assignment with no variable keywords.<br>
Create or update a variable:<br>
x = value<br>
<br>
------------------------------------------<br>
4. Loops<br>
------------------------------------------<br>
Loop a set number of times:<br>
loop number-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-<br>
<br>
Loop a random number of times:<br>
loop random-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-<br>
<br>
Loop infinitely:<br>
loop infinite-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-<br>
<br>
------------------------------------------<br>
5. Functions<br>
------------------------------------------<br>
Functions use no parentheses and use - to mark blocks.<br>
<br>
Function declaration:<br>
make functionName-parameters-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-<br>
<br>
Example:<br>
make greet-name-<br>
&nbsp;&nbsp;&nbsp;&nbsp;show screen "Hello " + name<br>
-<br>
<br>
Multiple parameters:<br>
make add-x, y-<br>
&nbsp;&nbsp;&nbsp;&nbsp;return x + y<br>
-<br>
<br>
Anonymous functions:<br>
func-parameters-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-<br>
<br>
Assigning an anonymous function:<br>
double = func-x-<br>
&nbsp;&nbsp;&nbsp;&nbsp;x * 2<br>
-<br>
<br>
Async functions:<br>
make fetchUser-id async-<br>
&nbsp;&nbsp;&nbsp;&nbsp;res = await fetch("/user/" + id)<br>
&nbsp;&nbsp;&nbsp;&nbsp;return await res.json()<br>
-<br>
<br>
Return values:<br>
Explicit return: return value<br>
Implicit return: last line is returned automatically<br>
<br>
------------------------------------------<br>
6. Comments<br>
------------------------------------------<br>
Write a comment using:<br>
Comment: your comment here-<br>
<br>
------------------------------------------<br>
7. Math<br>
------------------------------------------<br>
Math expressions use the nE/e: prefix.<br>
Examples:<br>
nE/e: x*y = z<br>
nE/e: x/y = z<br>
nE/e: x-y = z<br>
nE/e: x+y = z<br>
nE/e stands for numericalExpression/equation.<br>
<br>
------------------------------------------<br>
8. Conditionals<br>
------------------------------------------<br>
If statement:<br>
if condition-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-<br>
<br>
If / else statement:<br>
if condition-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-else-<br>
&nbsp;&nbsp;&nbsp;&nbsp;code<br>
-<br>
<br>
------------------------------------------<br>
9. Block Structure<br>
------------------------------------------<br>
Blocks begin with - after the header and end with a standalone -.<br>
Example:<br>
if x > 10-<br>
&nbsp;&nbsp;&nbsp;&nbsp;show screen "big"<br>
-<br>
<br>
------------------------------------------<br>
10. Full Example Program<br>
------------------------------------------<br>
code.J;<br>
<br>
make process-items-<br>
&nbsp;&nbsp;&nbsp;&nbsp;out = []<br>
&nbsp;&nbsp;&nbsp;&nbsp;loop items.length-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v = items[i]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if v > 10-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out.push(v)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;out<br>
-<br>

</details>

<script>
function updateLineNumbers() {
  const code = document.getElementById("code");
  const lineNumbers = document.getElementById("lineNumbers");

  const lines = code.value.split("\n").length;
  let numberText = "";

  for (let i = 1; i <= lines; i++) {
    numberText += i + "<br>";
  }

  lineNumbers.innerHTML = numberText;
}

// Run once on load
updateLineNumbers();

function runJ() {
  const input = document.getElementById("code").value.split("\n");
  const screen = document.getElementById("screen");
  screen.innerHTML = "";

  let vars = {};
  let started = false;

  for (let rawLine of input) {
    let line = rawLine.trim();
    if (line === "") continue;

    // Header
    if (!started) {
      if (line === "code.J;") {
        started = true;
        continue;
      } else {
        screen.innerHTML = "❌ Missing code.J; header";
        return;
      }
    }

    // Comment
    if (line.startsWith("Comment:")) continue;

    // show screen
    if (line.startsWith("show screen")) {
      let text = line.replace("show screen", "").trim();
      screen.innerHTML += text + "<br>";
      continue;
    }

    // show console
    if (line.startsWith("show console")) {
      let text = line.replace("show console", "").trim();
      console.log(text);
      continue;
    }

    // Math expression
    if (line.startsWith("nE/e:")) {
      let expr = line.replace("nE/e:", "").trim();
      try {
        let result = eval(expr);
        screen.innerHTML += result + "<br>";
      } catch {
        screen.innerHTML += "❌ Math error<br>";
      }
      continue;
    }

    // Variable assignment
    if (line.includes("=")) {
      let parts = line.split("=");
      let name = parts[0].trim();
      let value = parts[1].trim();

      if (!isNaN(value)) {
        vars[name] = Number(value);
      } else {
        vars[name] = value;
      }
      continue;
    }

    // Unknown command
    screen.innerHTML += "❌ Unknown command: " + line + "<br>";
  }
}
</script>

</body>
</html>
